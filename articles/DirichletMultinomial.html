<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>DirichletMultinomial for Clustering and Classification of Microbiome Data • DirichletMultinomial</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DirichletMultinomial for Clustering and Classification of Microbiome Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DirichletMultinomial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.47.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/DirichletMultinomial.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mtmorgan/DirichletMultinomial/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="DirichletMultinomial_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="DirichletMultinomial_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="DirichletMultinomial_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="DirichletMultinomial_files/datatables-binding-0.33/datatables.js"></script><link href="DirichletMultinomial_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="DirichletMultinomial_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="DirichletMultinomial_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="DirichletMultinomial_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="DirichletMultinomial_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>DirichletMultinomial for Clustering and Classification of Microbiome Data</h1>
                        <h4 data-toc-skip class="author">Martin
Morgan</h4>
            <address class="author_afil">
      Roswell Park Comprehensive Cancer Center, Buffalo,
NY<br><h4 data-toc-skip class="date">19 October 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mtmorgan/DirichletMultinomial/blob/devel/vignettes/DirichletMultinomial.Rmd" class="external-link"><code>vignettes/DirichletMultinomial.Rmd</code></a></small>
      <div class="d-none name"><code>DirichletMultinomial.Rmd</code></div>
    </address>
</div>

    
    
<p>Modified: 6 March 2012, 19 October 2024 (HTML version)</p>
<p>This document illustrates the main features of the
<em>DirichletMultinomial</em> package, and in the process replicates key
tables and figures from Holmes et al., <a href="https://doi.org/10.1371/journal.pone.0030126" class="external-link uri">https://doi.org/10.1371/journal.pone.0030126</a>.</p>
<p>We start by loading the package, in addition to the packages
<em>lattice</em> (for visualization) and <em>parallel</em> (for use of
multiple cores during cross-validation).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mtmorgan.github.io/DirichletMultinomial/">DirichletMultinomial</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></code></pre></div>
<p>We set the width of <span class="sans-serif">R</span> output to 70
characters, and the number of floating point digits displayed to two.
The <code>full</code> flag is set to <code>FALSE</code>, so that cached
values are used instead of re-computing during production of this
vignette. The package defines a set of standard colors; we use
<code>.qualitative</code> during visualization.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">70</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">full</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">.qualitative</span> <span class="op">&lt;-</span> <span class="fu">DirichletMultinomial</span><span class="fu">:::</span><span class="va">.qualitative</span></span></code></pre></div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The data used in Homes et al. is included in the package. We read the
data in to a matrix <code>count</code> of samples by taxa.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"DirichletMultinomial"</span>, <span class="st">"extdata"</span>, <span class="st">"Twins.csv"</span><span class="op">)</span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">fl</span>, row.names<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">count</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;         Acetanaerobacterium Acetivibrio Acetobacterium</span></span>
<span><span class="co">#&gt; TS1.2                     0           0              0</span></span>
<span><span class="co">#&gt; TS10.2                    0           0              0</span></span>
<span><span class="co">#&gt; TS100.2                   0           0              0</span></span>
<span><span class="co">#&gt; TS100                     1           0              0</span></span>
<span><span class="co">#&gt; TS101.2                   0           0              0</span></span></code></pre></div>
<p>The figure below shows the distribution of reads from each taxon, on
a log scale.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cnts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html" class="external-link">densityplot</a></span><span class="op">(</span></span>
<span>    <span class="va">cnts</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span>,</span>
<span>    xlab<span class="op">=</span><span class="st">"Taxon representation (log 10 count)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="DirichletMultinomial_files/figure-html/taxon-counts-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="clustering">Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h2>
<p>The <code>dmn</code> function fits a Dirichlet-Multinomial model,
taking as input the count data and a parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
representing the number of Dirichlet components to model. Here we fit
the count data to values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
from 1 to 7, displaying the result for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">k = 4</annotation></semantics></math>.
A sense of the model return value is provided by the documentation for
the <span class="sans-serif">R</span> object <code>fit</code>,
<code><a href="../reference/DMN-class.html">class ? DMN</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="va">full</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="va">dmn</span>, count<span class="op">=</span><span class="va">count</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">fit</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"fit.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; class: DMN </span></span>
<span><span class="co">#&gt; k: 4 </span></span>
<span><span class="co">#&gt; samples x taxa: 278 x 130 </span></span>
<span><span class="co">#&gt; Laplace: 38781 BIC: 40425 AIC: 39477</span></span></code></pre></div>
<p>The return value can be queried for measures of fit (Laplace, AIC,
BIC); these are plotted for different
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
in The figure. The best fit is for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">k=4</annotation></semantics></math>
distinct Dirichlet components.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lplc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">laplace</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lplc</span>, type<span class="op">=</span><span class="st">"b"</span>, xlab<span class="op">=</span><span class="st">"Number of Dirichlet Components"</span>, ylab<span class="op">=</span><span class="st">"Model Fit"</span><span class="op">)</span></span></code></pre></div>
<p><img src="DirichletMultinomial_files/figure-html/min-laplace-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">best</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">lplc</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; class: DMN </span></span>
<span><span class="co">#&gt; k: 4 </span></span>
<span><span class="co">#&gt; samples x taxa: 278 x 130 </span></span>
<span><span class="co">#&gt; Laplace: 38781 BIC: 40425 AIC: 39477</span></span></code></pre></div>
<p>In addition to <code>laplace</code> goodness of fit can be assessed
with the <code>AIC</code> and <code>BIC</code> functions.</p>
<p>The <code>mixturewt</code> function reports the weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>π</mi><annotation encoding="application/x-tex">\pi</annotation></semantics></math>
and homogeneity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
(large values are more homogeneous) of the fitted model.
<code>mixture</code> returns a matrix of sample x estimated Dirichlet
components; the argument <code>assign</code> returns a vector of length
equal to the number of samples indicating the component with maximum
value.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fitted.html">mixturewt</a></span><span class="op">(</span><span class="va">best</span><span class="op">)</span></span>
<span><span class="co">#&gt;     pi theta</span></span>
<span><span class="co">#&gt; 1 0.31    52</span></span>
<span><span class="co">#&gt; 2 0.17    19</span></span>
<span><span class="co">#&gt; 3 0.30    53</span></span>
<span><span class="co">#&gt; 4 0.22    30</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitted.html">mixture</a></span><span class="op">(</span><span class="va">best</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]    [,2]    [,3]    [,4]</span></span>
<span><span class="co">#&gt; TS1.2   1.0e+00 2.1e-11 8.6e-06 3.3e-08</span></span>
<span><span class="co">#&gt; TS10.2  3.8e-08 3.3e-04 1.0e+00 2.8e-10</span></span>
<span><span class="co">#&gt; TS100.2 7.2e-09 8.8e-01 8.0e-13 1.2e-01</span></span></code></pre></div>
<p>The <code>fitted</code> function describes the contribution of each
taxonomic group (each point in the panels of the figure to the Dirichlet
components; the diagonal nature of the points in a panel suggest that
the Dirichlet components are correlated, perhaps reflecting overall
numerical abundance.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/splom.html" class="external-link">splom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">best</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="DirichletMultinomial_files/figure-html/fitted-1.png" width="700"></p>
<p>The posterior mean difference between the best and single-component
Dirichlet multinomial model measures how each component differs from the
population average; the sum is a measure of total difference from the
mean.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, scale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># scale by theta</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">best</span>, scale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">meandiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p4</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   m1   m2   m3   m4 </span></span>
<span><span class="co">#&gt; 0.26 0.47 0.51 0.34</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">meandiff</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.6</span></span></code></pre></div>
<p>The table below summarizes taxonomic contributions to each Dirichlet
component.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p4</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">diff</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">cdiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">diff</span><span class="op">[</span><span class="va">o</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Mean<span class="op">=</span><span class="va">p0</span><span class="op">[</span><span class="va">o</span><span class="op">]</span>, <span class="va">p4</span><span class="op">[</span><span class="va">o</span>,<span class="op">]</span>, diff<span class="op">=</span><span class="va">diff</span><span class="op">[</span><span class="va">o</span><span class="op">]</span>, <span class="va">cdiff</span><span class="op">)</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html" class="external-link">formatRound</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"data":[["Bacteroides","Uknown","Faecalibacterium","Prevotella","Alistipes","Dorea","Ruminococcus","Oscillibacter","Roseburia","Subdoligranulum","Collinsella","Eubacterium","Hespellia","Coprococcus","Streptococcus","Coprobacillus","Catenibacterium","Eggerthella","Clostridium","Anaerotruncus","Odoribacter","Barnesiella","Megasphaera","Paraprevotella","Lactobacillus","Butyricimonas","Butyricicoccus","Lactonifactor","Parabacteroides","Dialister","Phascolarctobacterium","Sporacetigenium","Sutterella","Turicibacter","Anaerostipes","Parasutterella","Holdemania","Lactococcus","Acetanaerobacterium","Pseudobutyrivibrio","Olsenella","Desulfovibrio","Acidaminococcus","Akkermansia","Bifidobacterium","Veillonella","Slackia","Sporobacter","Lachnobacterium","Citrobacter","Actinomyces","Asaccharobacter","Allisonella","Marvinbryantia","Tepidibacter","Oribacterium","Escherichia/Shigella","Gordonibacter","Acetivibrio","Butyrivibrio","Robinsoniella","Cloacibacillus","Anaerofilum","Peptostreptococcus","Leuconostoc","Megamonas","Mitsuokella","Oxalobacter","Granulicatella","Ethanoligenens","Victivallis","Klebsiella","Corynebacterium","Haemophilus","Enterococcus","Solobacterium","Desulfocurvus","Anaerosporobacter","Weissella","Rothia","Anaerobacter","Atopobium","Fusobacterium","Succiniclasticum","Syntrophococcus","Papillibacter","Paraeggerthella","Gemella","Pyramidobacter","Sneathia","Campylobacter","Selenomonas","Xylanibacter","Acetobacterium","Zymophilus","Dysgonomonas","Anaerobiospirillum","Asticcacaulis","Proteus","Pediococcus","Bulleidia","Peptococcus","Hydrogenoanaerobacterium","Enterobacter","Sarcina","Propionibacterium","Anaerofustis","Coraliomargarita","Enterorhabdus","Porphyromonas","Dickeya","Ralstonia","Actinobaculum","Luteococcus","Brachyspira","Rhizobium","Bradyrhizobium","Microbacterium","Varibaculum","Sphingomonas","Methylobacterium","Arthrobacter","Caulobacter","Solirubrobacter","Coriobacterium","Hallella","Mobiluncus","Moryella","Pelomonas","Geosporobacter"],[0.1745820528764175,0.3081841760275629,0.1002524647801608,0.006006717419726193,0.02328709753204746,0.0270907657068392,0.0205048061773193,0.02558572839989603,0.04133788611249375,0.02844479718528463,0.01366463019746694,0.01027867017940429,0.01037731138413083,0.02373566545270548,0.01123796170550397,0.01125947620290049,0.003475869332360322,0.004695103674321348,0.007368839964511804,0.01022082837163489,0.006735346000691885,0.005556256304090484,0.003843215729787711,0.002939412949086375,0.002946557150019383,0.00420397752105043,0.008701227852767349,0.006316627384010886,0.007680829789194184,0.005707302226538293,0.004858426139166489,0.004729909358469641,0.003610547909547087,0.004178172338213763,0.001548079276573503,0.004200826461870645,0.003918966428423037,0.001538489597448981,0.004176557407395192,0.002766952442881993,0.0009472292718458544,0.002921214787971832,0.00196256607367426,0.003393437897724525,0.002189737972964386,0.001926560836942368,0.001645594182371679,0.001879084763095486,0.001973703058212889,0.0008849681500572012,0.000978672372321548,0.0025619821890048,0.001307272240693531,0.001434432206025562,0.002319319573134749,0.002255750352370585,0.0004927622875990528,0.001198117586696553,0.001683001322044561,0.0006302451696271594,0.0007349189976035893,0.0005986648203052528,0.0006611484401681773,0.0002803900766658333,0.0003839003765153404,0.0003632031483099235,0.0003934953911634974,0.0005577424217053079,0.0003835919059002347,0.0004896359556084454,0.0004548710573643375,0.000564349110878159,0.0002456762977806918,0.0005579991850911263,0.00042487205405156,0.0003517424569983738,0.0004197420445592085,0.0001417939454018515,0.0002477049667005428,0.0002798412147830131,0.0002110785059085913,0.0001071042855166473,0.0002465495418934328,0.0003927175702413115,0.0003835803394487014,0.0001778002197287024,0.0001767810405174778,0.0001761233204259608,0.0001073870574926489,7.259888929771771e-05,0.0001418440328910035,0.0001073127642537762,0.0002126131571027604,0.0001074279926452285,7.258352470773564e-05,7.2547432571038e-05,3.802928954333909e-05,3.801710235108792e-05,3.800450381432314e-05,3.796250279536719e-05,3.787315752453506e-05,0.0001764492349357954,0.0001763218157494936,0.000141808588280638,0.0002116006714267995,0.0001767411901773503,0.0001071746747631877,0.0001070439701970146,0.0001070447357272351,7.260191229032036e-05,7.272829465569498e-05,7.268507627790232e-05,7.241771920417196e-05,3.79822036640287e-05,3.797107258851462e-05,3.793000064649985e-05,3.786005574395701e-05,3.784761095598719e-05,7.262618434177994e-05,3.805030582639722e-05,3.79761031727751e-05,3.797062989428632e-05,3.796686623287796e-05,3.79665200756235e-05,3.787971772713873e-05,3.817551908520768e-05,3.790148308845309e-05,3.789019763763586e-05,3.789019763763586e-05,3.809610547569176e-05],[0.2261874184448933,0.335898432177486,0.08763426956395895,0.002205497804626132,0.04017078869909459,0.01494119076645807,0.03572586631768983,0.03956094261580854,0.02318938351780853,0.03041273379167217,0.00663529237552143,0.00403341475094951,0.006479246925074381,0.01902510496415892,0.005723000753811988,0.009494411357312306,0.0009262274652215131,0.003039957375360698,0.004186028631778653,0.008493890813154907,0.006210488404732721,0.006007057446862919,0.001097512595303975,0.001134613985694238,0.001232754126875296,0.003018450594185717,0.004718997520739669,0.003455367010878376,0.006447667001110802,0.002655491875480594,0.005712826731584828,0.003470625346808885,0.002052131313949257,0.003119572723032114,0.0008306646619195129,0.00335655156711473,0.003176486341605947,0.0005255776776070153,0.003863489579018196,0.001423331228540542,0.0002512489184254069,0.001790995921487048,0.0005505464745844584,0.003923081925474575,0.000801725010317114,0.0002404925233655651,0.0009570682049783089,0.001250366409732148,0.001690773639289285,0.0002585908912194177,0.0005074954114240903,0.002064507008523855,0.0002572755144038461,0.001075190013888372,0.001224680684559404,0.001103723916392862,0.0002582422078569358,0.001153826759150929,0.001696137186044566,0.0005227295919668771,0.0001907512381477929,0.0008733541971129444,0.0008829652366795464,6.899042619137634e-05,6.848745116074729e-05,7.2472856873091e-06,0.0001973938052603545,0.0007353365194320819,0.0001282836440354133,0.0007025891669981682,0.0004452907463010731,0.0005837973132033224,0.0001936365923022009,0.0003732842674138063,0.0002579216324571161,0.0001314903624897522,0.000394643583658731,0.0001303790250619927,0.0001352849308622445,0.0001931936155113878,6.856902817919681e-05,6.242800810275943e-06,0.0001921539005723831,0.0004018350835846737,0.0004111953082469493,0.0002597586296883385,0.0001312879110466159,0.0001308677604300182,6.85532406573085e-05,6.242800790029095e-06,0.0001939558263151452,0.0001944849929888756,6.855314423548423e-05,6.922690077348925e-05,6.806258074353516e-05,6.242906153584551e-06,6.242800789998743e-06,6.242800789999264e-06,6.242800789998743e-06,6.242800790507571e-06,6.242800790006594e-06,0.0002033394559678655,0.0001940808546523212,0.00013129198829889,0.0001325455387744801,7.343759491348403e-05,0.0001308691136201298,0.0001311926206767069,0.0001308670309970259,0.0001308691139461155,6.855288753858497e-05,6.87757294154399e-05,6.855324376283395e-05,6.242800789999276e-06,6.242800791102121e-06,6.242800789999276e-06,6.242800790029705e-06,6.318609067442039e-06,6.886218977031913e-05,6.245244785183366e-06,6.242800824643501e-06,6.246361908803678e-06,6.242955180823835e-06,6.242800808956421e-06,6.678250977679206e-06,6.924851930929558e-05,6.855324375751323e-05,6.855324376256672e-05,6.855324376256672e-05,6.844324325464167e-05],[0.08339212622181233,0.451915791033611,0.03985968836132055,0.004008453585616192,0.009931874363515978,0.04050282318288764,0.009223507031600953,0.01204927677047361,0.05396127524910993,0.01624550525877017,0.01757705236811022,0.01161248314561623,0.01946152627176496,0.02308523239272021,0.01646263704398625,0.01579706827345648,0.003046673424114316,0.01002370826104059,0.01027617138194782,0.007588871848035714,0.002095315757458814,0.001343043743631558,0.005432083844265443,0.001839491437458009,0.004000207697114482,0.00131116958229503,0.008370338450598742,0.008122185861219881,0.006810728715520822,0.007790027535544457,0.005281140442015577,0.006330682080978499,0.003166420883910473,0.005837947066169649,0.004610273511378349,0.003330024937853106,0.003541572900646011,0.004044042190552082,0.003089832109849235,0.004230192626537371,0.0002991950508847041,0.001480899460428024,0.00286065730721289,0.003518213743988097,0.003670881253717852,0.003531879919658217,0.001945244708528057,0.0004095705662405851,0.0007934313190321042,0.002368859372970032,0.002550840921390823,0.002655545019893611,0.001748455564444,0.000769517572454774,0.002336501533922257,0.001688091709242605,0.001805305973817033,0.002091698036792728,0.00177887587676752,2.813113562008124e-05,0.0007857628938077344,2.462449778029727e-05,2.46115081717374e-05,0.001257674353281624,0.001255772608243856,0.000869706001589631,0.0002722517470625046,2.461229278401884e-05,0.0009948304441316004,0.0002709164289073541,2.461476563540836e-05,0.0007846869359607321,0.0007673353326116166,2.46277732637681e-05,0.0007806334836276774,2.461151720637301e-05,2.462740609080109e-05,0.0005213608640357506,2.58652922448823e-05,0.0005307315562558839,0.0002708546945327211,0.0002708509839238092,0.0002751326457033988,0.0002772403074090595,0.0003651230584952272,2.461148038524153e-05,0.0002708117319274859,2.495848006432649e-05,2.46215257813803e-05,2.461553746530086e-05,2.513048561168532e-05,2.461145476782646e-05,0.0002721121963858182,0.0002732360713770676,0.0002727478668401278,0.0002708504253596968,0.0002720983026349122,0.0002708500580814009,0.0002708500422032487,0.0002708192820283118,0.0002708500580810607,2.592444281054523e-05,2.461155108225947e-05,0.0002708530371883142,0.0002721118434062277,0.0002726738737097005,2.46155382404764e-05,2.461145382305959e-05,2.461145655083522e-05,2.46114535268303e-05,2.461742770026054e-05,2.461148346855178e-05,2.461553744805777e-05,2.461752919839651e-05,2.461145350712006e-05,2.461145358251276e-05,2.461553744803938e-05,2.461149033187457e-05,2.462540268720416e-05,2.462359648760913e-05,2.461145350645501e-05,2.461145357107338e-05,2.461145356810114e-05,2.461407182714239e-05,2.461145378180292e-05,2.461145381402555e-05,2.461145352710017e-05,2.461145350703584e-05,2.461145350703584e-05,2.461145392537106e-05],[0.3881080086308599,0.2241562070012889,0.1382582831620792,0.001377980307165069,0.01660930731376706,0.01734938602826369,0.009541978373287904,0.01590552512443164,0.04467483329501184,0.01906546936860944,0.006696640544381913,0.005161178844203901,0.006894157965478973,0.01322197168760758,0.006171733227883559,0.005919448859890061,0.001499491491203215,0.00215064757849792,0.003916431410002667,0.005223260816518032,0.003206824001602123,0.002196043977888657,0.002035448191483209,0.001007290548462162,0.0008119556209310278,0.002027221508128988,0.005997716064672511,0.003434422050182471,0.004026308828476878,0.004160893305310785,0.002829171673913385,0.002134135977841265,0.001494641392709306,0.001682731028223425,0.0005304987851072845,0.003622957630127004,0.002500225571004769,0.0005276841164320042,0.00123098906653161,0.001656737305606602,0.0001324997624741874,0.001672372616810248,0.001008990190695763,0.0008312013085363746,0.001201509724674159,0.001908116468812847,0.0001976819960715428,0.00111957421164163,0.000765868935037481,0.0006603241920005664,0.0002008165073502074,0.001237712766176765,0.0008065888492464478,0.0004314158123626103,0.001238452043711768,0.001713855902521855,0.0002023975778453839,7.886055668437893e-05,0.0007338178053839031,0.0001284888285291665,0.000329672038926767,0.0001210032532235823,0.0001362555045590101,0.0001358794004021542,0.0001338340233067026,0.0001382672226524047,6.453550312730195e-06,1.152833806206232e-05,0.0002064666214461374,8.463824844962505e-06,7.117559346364691e-05,0.0002057242139399739,6.489035052841718e-06,0.0004018768041737411,0.0002063659260400574,0.0002671172447529086,0.0001875424339841465,6.461045078008524e-06,0.000130528536699204,0.0001354130072394524,7.130617680054931e-05,6.450642074752893e-06,7.511858471588258e-06,0.0001381946294945047,7.26537337656005e-05,9.627317577574032e-06,6.450642074752893e-06,7.090513048393961e-05,6.45064268117132e-06,6.450642074752762e-06,7.097363453440763e-05,6.453549372629366e-06,0.0001384117929463263,6.472168511524916e-06,6.461068755156276e-06,7.093885388452592e-05,6.450642074786473e-06,6.450642074752893e-06,6.450642074753134e-06,6.458779609402465e-06,6.450642074752636e-06,6.145814376843621e-05,7.060399465209684e-05,6.450642074752762e-06,0.0001354353018106146,0.0001305528468357936,6.450642074752762e-06,7.06039064388709e-05,7.09412071826024e-05,6.450642140162461e-06,6.450642327079595e-06,6.498208476604097e-06,6.450642074752762e-06,6.450642074752762e-06,6.450642074752762e-06,6.450642074752762e-06,6.450642074752762e-06,6.450770781760678e-06,7.084598220107701e-05,7.11770168169123e-05,7.093905930451287e-05,7.093544804991124e-05,7.093890050223049e-05,7.093838333288112e-05,7.049606173305547e-05,6.450642076225799e-06,6.450642074752762e-06,6.450642074769617e-06,6.450642074769617e-06,6.451239613715807e-06],[0.06786489457735442,0.2914215091338282,0.138044252807898,0.05177004267159226,0.01864940768791066,0.03317741011029449,0.02363853746355333,0.02843496830006063,0.03630070727266511,0.03397115898695648,0.02321921208517741,0.02468695718027826,0.005351738612579947,0.02839190600924626,0.01211910238936786,0.007709243758689537,0.01093486781546045,0.00239636826605395,0.006800238684122757,0.01074074118649206,0.007724614250564994,0.00707259132700914,0.006838487757634561,0.007082289435873637,0.005980207729756176,0.005832714270754948,0.007855721223616793,0.006482274152055671,0.005918607617260068,0.004929630801518406,0.001039176113723162,0.003822328077562495,0.005466497100458542,0.003475905041061482,0.0007127010936941666,0.001149103843982009,0.00145097705755169,0.001720243950889727,0.004414054283501504,0.002179058532169914,0.003264165593611716,0.003561941304310046,0.00313653299593464,0.002227096634528099,0.002404959038128191,0.001307219166251455,0.003093705046752096,0.002288846684885002,0.002377041365705359,0.0002943335465691853,0.0009741255276782351,0.001656352177676569,0.002013739250689976,0.002049991754120003,0.00274042028922787,0.002140468973388072,1.376517162349856e-05,0.0009753686045252662,0.0005800033449931024,0.001122639676620707,0.001423668537614673,0.0002884372202721574,0.0004266361300885214,1.649794407865902e-05,0.0004310653137675115,0.000747254579091251,0.001072000458252608,0.0006073924656263881,0.0002883874278797002,0.0002889134262219101,0.0007076524082167607,0.0001444596882153634,0.0001510763003237675,0.0005702624817214414,0.0002931983627034106,0.000576795894655689,0.0004306017230002196,1.373526575926229e-05,0.0004465303750084145,0.0001434774017563201,0.0004257285414590147,0.0002884224349457003,0.000429802688705014,0.0002894089211402479,0.0003011658167788062,0.0001517048620218248,0.00029119532188416,0.0002883042886996042,0.0002930850927462867,0.0002884206672168996,1.373606020499361e-05,1.509683053165862e-05,0.0002921744999170266,0.0001510738534235702,1.373526566999974e-05,1.373526567368185e-05,1.373526565130638e-05,1.373526565136171e-05,1.373527462968015e-05,1.373526565145018e-05,1.37352656515375e-05,0.000150810685643926,0.0001511935291994385,0.0001510769083587025,0.0001507422017732373,0.0001522286074175821,0.0001510762907134572,1.373618022737061e-05,1.373526944815245e-05,1.373526566979556e-05,0.0001520180835144369,0.0001511094572396695,0.0001510762902665805,0.0001510751754270749,0.0001510785729214781,0.0001510785728817988,0.0001510762902665805,0.000150911796705518,1.373526692028147e-05,1.373526565135371e-05,1.373526565157996e-05,1.373526565131086e-05,1.373526566893936e-05,1.373526755957224e-05,1.373526576143662e-05,1.373606064252997e-05,1.373526565130638e-05,1.373526565130638e-05,1.373526565130638e-05,1.447714191621778e-05],[0.4630384062765864,0.2722365070759798,0.1488085780446977,0.05619154581363726,0.04155439439799581,0.04138965649846037,0.0405989183763543,0.04004110902096393,0.03914601775364812,0.02907291815124904,0.02746433153338429,0.02710484673074108,0.02149100553689331,0.02053092787017051,0.01668700545165856,0.01519291670336556,0.01241421409964205,0.01182694238977071,0.01011115258506735,0.00987637445205319,0.009682678088155107,0.009540561052351843,0.00913761081511282,0.008979719362431977,0.007935705679064334,0.007883827628246073,0.00786213815144168,0.007714670952214705,0.007520006994408166,0.007458616006311257,0.007125619385963858,0.006363411395705136,0.005974399328983679,0.005916082950280155,0.005632567523804391,0.005344667868405729,0.005006603842883731,0.004711024347402789,0.004582858342892847,0.004504970445984299,0.004475680405519126,0.00446010288152839,0.004437653637867309,0.004382997726398198,0.00407260555685477,0.003929173435113086,0.003884199554230301,0.003267505023461611,0.003074373588772268,0.002925547043295265,0.002825748219581386,0.002820937445526021,0.002698330451483682,0.00264273276746537,0.002613789094878954,0.002376860907936948,0.00231642559168932,0.002279877289825261,0.00216119191243508,0.001703780459758901,0.001689008154347847,0.001636618866447413,0.001617758974196632,0.001597086735941101,0.001484516447543917,0.001471446072341168,0.001382892137944014,0.001306588354212389,0.001138876562570819,0.001113567398240832,0.001076313417545307,0.001018300347008717,0.0009074860004941901,0.0008864720070523786,0.0008728916705302132,0.0008570616842034028,0.000663272388384958,0.00065437341894019,0.0006502615486031693,0.0006183299613147497,0.0005567080310119897,0.0005465799759844807,0.0005052695753644415,0.0004824263660234846,0.0004394133781047182,0.0004294154091611031,0.0004242685006902771,0.0004138195585732414,0.0004082337986117244,0.0003963094654822523,0.0003678037117460656,0.0003629486868243136,0.0003573217591210342,0.0003486108555156236,0.0003296560010869079,0.0003250282647899805,0.0003217281732054988,0.0003204555542674629,0.000320430332337463,0.0003203074415676859,0.0003201676646138341,0.0003180446536165489,0.0003003154112175136,0.0002841873151733739,0.0002765901439014947,0.0002699372048975414,0.0002508792240183578,0.000236329020581435,0.0002356685692699061,0.0002312755771899679,0.0001978537152599018,0.0001965941884348783,0.00019629230538928,0.0001897286106919837,0.0001897158217255324,0.0001896336777275337,0.0001894874214416727,0.000189226148436415,0.000112435895788238,0.0001026735215455605,0.0001023017456673846,0.000102283626707296,0.0001022829585501221,0.0001022792832884571,0.0001012305266664142,0.0001008014009469296,9.955884868126009e-05,9.953627780472661e-05,9.953627780472661e-05,9.909561875072055e-05],[0.2924864134400798,0.4644494266216378,0.5584470015342755,0.5939413870493885,0.6201899565317315,0.6463344664010064,0.6719794925251534,0.6972721684867006,0.7219994441900189,0.7403638680542814,0.7577121996804285,0.7748334563616335,0.7884086307866943,0.8013773551429114,0.8119179977968499,0.8215148728206614,0.8293565311117724,0.8368272288220617,0.8432141175018426,0.8494527044141056,0.8555689395862,0.8615954040145991,0.8673673377861731,0.8730395366241401,0.8780522657211713,0.8830322251282279,0.8879984839929665,0.8928715925884895,0.8976217382460073,0.9023331051981682,0.9068341289350519,0.9108536904900858,0.9146275256806584,0.9183645242973733,0.9219224353716277,0.925298489527543,0.928460999551918,0.9314368015508945,0.9343316452222767,0.9371772896235587,0.9400044324518199,0.9428217354610497,0.9456248580077652,0.9483934561796078,0.950965989638029,0.9534479216554216,0.9559014451241072,0.9579654225658376,0.9599074051149435,0.9617553787396897,0.9635403126692014,0.9653222077880435,0.967026656026748,0.9686959850032624,0.9703470311961634,0.9718484175018884,0.9733116287693124,0.9747517536543013,0.976116908817794,0.9771931319327865,0.9782600238593304,0.9792938231639385,0.9803157092834467,0.9813245374173902,0.9822622585341468,0.9831917235168257,0.9840652518378441,0.9848905815219176,0.9856099730812827,0.9863133776585711,0.9869932500988871,0.9876364775553228,0.9882097071663739,0.9887696629161414,0.9893210404057283,0.9898624186039762,0.9902813863599611,0.9906947329242243,0.991105482152735,0.9914960612283711,0.9918477157199139,0.9921929726460497,0.992512135125696,0.9928168682874262,0.9930944315332332,0.9933656793848129,0.9936336761004642,0.9938950725566927,0.9941529406686732,0.994403276564357,0.9946356062956283,0.9948648692643866,0.995090577884563,0.9953107841081373,0.9955190171620696,0.9957243270243756,0.9959275523253615,0.9961299737540467,0.9963323792508529,0.996534707121527,0.9967369466996118,0.9969378452401846,0.9971275447906692,0.9973070567435299,0.9974817698085501,0.9976522804267716,0.9978107527337013,0.9979600341468298,0.9981088983741854,0.9982549876902584,0.998379965495075,0.9985041476974561,0.9986281392100628,0.9987479846486182,0.9988678220087965,0.998987607481263,0.9991073005683552,0.9992268286177244,0.9992978507434385,0.9993627062924924,0.9994273270027257,0.9994919362677969,0.9995565451108148,0.9996211516322885,0.99968509568806,0.9997487686789676,0.9998116567897209,0.9998745306431804,0.9999374044966397,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>m1<\/th>\n      <th>m2<\/th>\n      <th>m3<\/th>\n      <th>m4<\/th>\n      <th>diff<\/th>\n      <th>cdiff<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Mean","targets":1},{"name":"m1","targets":2},{"name":"m2","targets":3},{"name":"m3","targets":4},{"name":"m4","targets":5},{"name":"diff","targets":6},{"name":"cdiff","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render"],"jsHooks":[]}</script><p>The figure shows samples arranged by Dirichlet component, with
samples placed into the component for which they had the largest fitted
value.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/heatmapdmn.html">heatmapdmn</a></span><span class="op">(</span><span class="va">count</span>, <span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">best</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="DirichletMultinomial_files/figure-html/heatmap-similarity-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="generative-classifier">Generative classifier<a class="anchor" aria-label="anchor" href="#generative-classifier"></a>
</h2>
<p>The following reads in phenotypic information (‘Lean’, ‘Obese’,
‘Overweight’) for each sample.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"DirichletMultinomial"</span>, <span class="st">"extdata"</span>, <span class="st">"TwinStudy.t"</span><span class="op">)</span></span>
<span><span class="va">pheno0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html" class="external-link">scan</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span>
<span><span class="va">lvls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lean"</span>, <span class="st">"Obese"</span>, <span class="st">"Overwt"</span><span class="op">)</span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">lvls</span><span class="op">[</span><span class="va">pheno0</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span>, levels<span class="op">=</span><span class="va">lvls</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span></span>
<span><span class="co">#&gt; pheno</span></span>
<span><span class="co">#&gt;   Lean  Obese Overwt </span></span>
<span><span class="co">#&gt;     61    193     24</span></span></code></pre></div>
<p>Here we subset the count data into sub-counts, one for each
phenotype. We retain only the Lean and Obese groups for subsequent
analysis.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span>, <span class="va">csubset</span>, <span class="va">count</span>, <span class="va">pheno</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">counts</span>, <span class="va">dim</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]   61  193   24</span></span>
<span><span class="co">#&gt; [2,]  130  130  130</span></span>
<span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lean"</span>, <span class="st">"Obese"</span><span class="op">)</span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="va">count</span><span class="op">[</span><span class="va">pheno</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">keep</span>,<span class="op">]</span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">[</span><span class="va">pheno</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">keep</span><span class="op">]</span>, levels<span class="op">=</span><span class="va">keep</span><span class="op">)</span></span></code></pre></div>
<p>The <code>dmngroup</code> function identifies the best (minimum
Laplace score) Dirichlet-multinomial model for each group.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="va">full</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">bestgrp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dmngroup.html">dmngroup</a></span><span class="op">(</span></span>
<span>        <span class="va">count</span>, <span class="va">pheno</span>, k<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, mc.preschedule<span class="op">=</span><span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">bestgrp</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"bestgrp.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bestgrp</span><span class="op">)</span></span></code></pre></div>
<p>The Lean group is described by a model with one component, the Obese
group by a model with three components. Three of the four Dirichlet
components of the original single group (<code>best</code>) model are
represented in the Obese group, the other in the Lean group. The total
Laplace score of the two group model is less than of the single-group
model, indicating information gain from considering groups
separately.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bestgrp</span></span>
<span><span class="co">#&gt; class: DMNGroup </span></span>
<span><span class="co">#&gt; summary:</span></span>
<span><span class="co">#&gt;       k samples taxa   NLE LogDet Laplace   BIC   AIC</span></span>
<span><span class="co">#&gt; Lean  1      61  130  9066    162    9027  9333  9196</span></span>
<span><span class="co">#&gt; Obese 3     193  130 26770    407   26613 27801 27162</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">bestgrp</span>, <span class="va">mixturewt</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Lean</span></span>
<span><span class="co">#&gt;   pi theta</span></span>
<span><span class="co">#&gt; 1  1    35</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Obese</span></span>
<span><span class="co">#&gt;     pi theta</span></span>
<span><span class="co">#&gt; 1 0.53    45</span></span>
<span><span class="co">#&gt; 2 0.26    33</span></span>
<span><span class="co">#&gt; 3 0.22    18</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">bestgrp</span>, <span class="va">laplace</span><span class="op">)</span>,</span>
<span>    <span class="st">'Lean+Obese'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">bestgrp</span>, <span class="va">laplace</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    Single <span class="op">=</span> <span class="fu"><a href="../reference/fitted.html">laplace</a></span><span class="op">(</span><span class="va">best</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;       Lean      Obese Lean+Obese     Single </span></span>
<span><span class="co">#&gt;       9027      26613      35641      38781</span></span></code></pre></div>
<p>The <code>predict</code> function assigns samples to classes; the
confusion matrix shows that the classifier is moderately effective.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span><span class="va">pheno</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bestgrp</span>, <span class="va">count</span>, assign<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        predict(bestgrp, count, assign = TRUE)</span></span>
<span><span class="co">#&gt; pheno   Lean Obese</span></span>
<span><span class="co">#&gt;   Lean    38    23</span></span>
<span><span class="co">#&gt;   Obese   15   178</span></span></code></pre></div>
<p>The <code>cvdmngroup</code> function performs cross-validation. This
is a computationally expensive step.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="va">full</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">## full leave-one-out; expensive!</span></span>
<span>    <span class="va">xval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cvdmngroup.html">cvdmngroup</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, <span class="va">count</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Lean<span class="op">=</span><span class="fl">1</span>, Obese<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, <span class="va">pheno</span>,</span>
<span>        verbose<span class="op">=</span><span class="cn">TRUE</span>, mc.preschedule<span class="op">=</span><span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">xval</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"xval.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">xval</span><span class="op">)</span></span></code></pre></div>
<p>The figure shows an ROC curve for the single and two-group
classifier. The single group classifier is performing better than the
two-group classifier.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc.html">roc</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Obese"</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bestgrp</span>, <span class="va">count</span><span class="op">)</span><span class="op">[</span>,<span class="st">"Obese"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">bst</span><span class="op">$</span><span class="va">Label</span> <span class="op">&lt;-</span> <span class="st">"Single"</span></span>
<span><span class="va">two</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc.html">roc</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">xval</span><span class="op">)</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Obese"</span>, <span class="va">xval</span><span class="op">[</span>,<span class="st">"Obese"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">two</span><span class="op">$</span><span class="va">Label</span> <span class="op">&lt;-</span> <span class="st">"Two group"</span></span>
<span><span class="va">both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">bst</span>, <span class="va">two</span><span class="op">)</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>superpose.line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">.qualitative</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>    <span class="va">TruePostive</span> <span class="op">~</span> <span class="va">FalsePositive</span>, group<span class="op">=</span><span class="va">Label</span>, <span class="va">both</span>,</span>
<span>    type<span class="op">=</span><span class="st">"l"</span>, par.settings<span class="op">=</span><span class="va">pars</span>,</span>
<span>    auto.key<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lines<span class="op">=</span><span class="cn">TRUE</span>, points<span class="op">=</span><span class="cn">FALSE</span>, x<span class="op">=</span><span class="fl">.6</span>, y<span class="op">=</span><span class="fl">.1</span><span class="op">)</span>,</span>
<span>    xlab<span class="op">=</span><span class="st">"False Positive"</span>, ylab<span class="op">=</span><span class="st">"True Positive"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="DirichletMultinomial_files/figure-html/ROC-dmngroup-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C          </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=C.UTF-8        LC_COLLATE=C.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C             </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C           LC_TELEPHONE=C        </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] parallel  stats4    stats     graphics  grDevices utils    </span></span>
<span><span class="co">#&gt; [7] datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] lattice_0.22-6              DirichletMultinomial_1.47.2</span></span>
<span><span class="co">#&gt; [3] IRanges_2.38.1              S4Vectors_0.42.1           </span></span>
<span><span class="co">#&gt; [5] BiocGenerics_0.50.0         BiocStyle_2.32.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] cli_3.6.3           knitr_1.48          rlang_1.1.4        </span></span>
<span><span class="co">#&gt;  [4] xfun_0.48           highr_0.11          textshaping_0.4.0  </span></span>
<span><span class="co">#&gt;  [7] jsonlite_1.8.9      DT_0.33             htmltools_0.5.8.1  </span></span>
<span><span class="co">#&gt; [10] ragg_1.3.3          sass_0.4.9          rmarkdown_2.28     </span></span>
<span><span class="co">#&gt; [13] grid_4.4.1          crosstalk_1.2.1     evaluate_1.0.1     </span></span>
<span><span class="co">#&gt; [16] jquerylib_0.1.4     fastmap_1.2.0       yaml_2.3.10        </span></span>
<span><span class="co">#&gt; [19] lifecycle_1.0.4     bookdown_0.41       BiocManager_1.30.25</span></span>
<span><span class="co">#&gt; [22] compiler_4.4.1      fs_1.6.4            htmlwidgets_1.6.4  </span></span>
<span><span class="co">#&gt; [25] systemfonts_1.1.0   digest_0.6.37       R6_2.5.1           </span></span>
<span><span class="co">#&gt; [28] magrittr_2.0.3      bslib_0.8.0         tools_4.4.1        </span></span>
<span><span class="co">#&gt; [31] pkgdown_2.1.1       cachem_1.1.0        desc_1.4.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Morgan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
